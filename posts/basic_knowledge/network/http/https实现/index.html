<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>HTTP:HTTPS实现 - 这是我的网站</title><meta name="Description" content="HTTPS实现"><meta property="og:title" content="HTTP:HTTPS实现" />
<meta property="og:description" content="HTTPS实现" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhangyuhu.github.io/posts/basic_knowledge/network/http/https%E5%AE%9E%E7%8E%B0/" /><meta property="og:image" content="https://zhangyuhu.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-09T14:32:52+08:00" />
<meta property="article:modified_time" content="2023-02-09T15:11:52+08:00" /><meta property="og:site_name" content="我的网站" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://zhangyuhu.github.io/logo.png"/>

<meta name="twitter:title" content="HTTP:HTTPS实现"/>
<meta name="twitter:description" content="HTTPS实现"/>
<meta name="application-name" content="我的网站">
<meta name="apple-mobile-web-app-title" content="我的网站"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://zhangyuhu.github.io/posts/basic_knowledge/network/http/https%E5%AE%9E%E7%8E%B0/" /><link rel="prev" href="https://zhangyuhu.github.io/posts/basic_knowledge/network/http/http/" /><link rel="next" href="https://zhangyuhu.github.io/posts/embedded/developmentboard/%E5%9C%B0%E5%B9%B3%E7%BA%BF%E6%97%AD%E6%97%A5x3/%E5%9C%B0%E5%B9%B3%E7%BA%BF%E6%97%AD%E6%97%A5x3/" /><link rel="stylesheet" href="/css/style.min.990eb8dd228a2b662f63cfe59575be8aa494cb9d40ffd854f26b9d9e588e1f4fdadb6a34e3f9a9171244d3ee6c107521923ab30705f3ef50d3e435eda1afc910.css" integrity="sha512-mQ643SKKK2YvY8/llXW+iqSUy51A/9hU8mudnliOH0/a22o04/mpFxJE0+5sEHUhkjqzBwXz71DT5DXtoa/JEA=="><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "HTTP:HTTPS实现",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/zhangyuhu.github.io\/posts\/basic_knowledge\/network\/http\/https%E5%AE%9E%E7%8E%B0\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/zhangyuhu.github.io\/images\/Apple-Devices-Preview.png",
                            "width":  3200 ,
                            "height":  2048 
                        }],"genre": "posts","keywords": "network, HTTP","wordcount":  2821 ,
        "url": "https:\/\/zhangyuhu.github.io\/posts\/basic_knowledge\/network\/http\/https%E5%AE%9E%E7%8E%B0\/","datePublished": "2023-02-09T14:32:52+08:00","dateModified": "2023-02-09T15:11:52+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "zhangyuhu"
            },"description": "HTTPS实现"
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="这是我的网站"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="文章"><i class='fas fa-archive fa-fw fa-sm'></i> 文章 </a><a class="menu-item" href="/tags/"><i class='fas fa-tags fa-fw fa-sm'></i> 标签 </a><a class="menu-item" href="/categories/"><i class='fas fa-th fa-fw fa-sm'></i> 分类 </a><a class="menu-item" href="/about/"><i class='fas fa-user-tie fa-fw fa-sm'></i> 关于 </a><a class="menu-item" href="/tool/"><i class='fas fa-cube fa-fw fa-sm'></i> 工具箱 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="这是我的网站"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="文章"><i class='fas fa-archive fa-fw fa-sm'></i>文章</a><a class="menu-item" href="/tags/" title=""><i class='fas fa-tags fa-fw fa-sm'></i>标签</a><a class="menu-item" href="/categories/" title=""><i class='fas fa-th fa-fw fa-sm'></i>分类</a><a class="menu-item" href="/about/" title=""><i class='fas fa-user-tie fa-fw fa-sm'></i>关于</a><a class="menu-item" href="/tool/" title=""><i class='fas fa-cube fa-fw fa-sm'></i>工具箱</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">HTTP:HTTPS实现</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://zhangyuhu.github.io/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>zhangyuhu</a></span>&nbsp;<span class="post-category">included in <a href="/categories/network/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>network</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-02-09">2023-02-09</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;2821 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#https-介绍">HTTPS 介绍</a>
      <ul>
        <li><a href="#https-简史">HTTPS 简史</a></li>
        <li><a href="#https-工作流程">HTTPS 工作流程</a></li>
      </ul>
    </li>
    <li><a href="#搭建https服务">搭建https服务</a>
      <ul>
        <li><a href="#首先确认安装openssl">首先确认安装OpenSSL</a></li>
        <li><a href="#自建ca">自建CA</a></li>
        <li><a href="#创建服务器公私钥">创建服务器公私钥</a></li>
        <li><a href="#使用-ca-key-对服务器证书签名">使用 CA key 对服务器证书签名</a></li>
        <li><a href="#搭建https工程">搭建https工程</a></li>
      </ul>
    </li>
    <li><a href="#参考">参考</a></li>
    <li><a href="#测试工程">测试工程</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><blockquote>
<p>本文采用<a href="http://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreffer ">知识共享署名 4.0 国际许可协议</a>进行许可，转载时请注明原文链接，图片在使用时请保留全部内容，可适当缩放并在引用处附上图片所在的文章链接。</p>
</blockquote>
<!-- TOC -->
<ul>
<li><a href="#https-%e4%bb%8b%e7%bb%8d" rel="">HTTPS 介绍</a>
<ul>
<li><a href="#https-%e7%ae%80%e5%8f%b2" rel="">HTTPS 简史</a></li>
<li><a href="#https-%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b" rel="">HTTPS 工作流程</a></li>
</ul>
</li>
<li><a href="#%e6%90%ad%e5%bb%bahttps%e6%9c%8d%e5%8a%a1" rel="">搭建https服务</a>
<ul>
<li><a href="#%e9%a6%96%e5%85%88%e7%a1%ae%e8%ae%a4%e5%ae%89%e8%a3%85openssl" rel="">首先确认安装OpenSSL</a></li>
<li><a href="#%e8%87%aa%e5%bb%baca" rel="">自建CA</a></li>
<li><a href="#%e5%88%9b%e5%bb%ba%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%85%ac%e7%a7%81%e9%92%a5" rel="">创建服务器公私钥</a></li>
<li><a href="#%e4%bd%bf%e7%94%a8-ca-key-%e5%af%b9%e6%9c%8d%e5%8a%a1%e5%99%a8%e8%af%81%e4%b9%a6%e7%ad%be%e5%90%8d" rel="">使用 CA key 对服务器证书签名</a></li>
<li><a href="#%e6%90%ad%e5%bb%bahttps%e5%b7%a5%e7%a8%8b" rel="">搭建https工程</a></li>
</ul>
</li>
<li><a href="#%e5%8f%82%e8%80%83" rel="">参考</a></li>
<li><a href="#%e6%b5%8b%e8%af%95%e5%b7%a5%e7%a8%8b" rel="">测试工程</a></li>
</ul>
<!-- /TOC -->
<h1 id="https-介绍">HTTPS 介绍</h1>
<h2 id="https-简史">HTTPS 简史</h2>
<p>在早期HTTP诞生的这几年间，1990年~·1994年，HTTP作为一个应用层协议，它是这样工作的：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016336.png"
        data-srcset="https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016336.png, https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016336.png 1.5x, https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016336.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016336.png"
        title="img" /></p>
<p>后来网景公司开发了SSL（Secure Sockets Layer）技术，然后它就变成了这样的HTTP，也就是<a href="https://en.wikipedia.org/wiki/HTTPS" target="_blank" rel="noopener noreffer ">HTTPS</a>了：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016541.png"
        data-srcset="https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016541.png, https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016541.png 1.5x, https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016541.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016541.png"
        title="img" /></p>
<p>后来爆发了与IE的世纪大战，网景败北，SSL移交给了<a href="https://en.wikipedia.org/wiki/Transport_Layer_Security" target="_blank" rel="noopener noreffer ">IETF（Internat Engineering Task Force）互联网工程任务组</a>，标准化之后变成了现在的TLS，现在一般会把它们两个放在一起称为<a href="https://en.wikipedia.org/wiki/Transport_Layer_Security" target="_blank" rel="noopener noreffer ">SSL/TLS</a>。本篇并不关注SSL/TLS具体是如何工作的，只是抽象的解释下HTTPS的一个工作流程。</p>
<h2 id="https-工作流程">HTTPS 工作流程</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016561.png"
        data-srcset="https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016561.png, https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016561.png 1.5x, https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016561.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/zhangyuhu/share_images/images/202302092016561.png"
        title="img" /></p>
<ol>
<li>Client发起一个HTTPS（https:/demo.linianhui.dev）的请求，根据RFC2818的规定，Client知道需要连接Server的443（默认）端口。</li>
<li>Server把事先配置好的<strong>公钥证书</strong>（public key certificate）返回给客户端。</li>
<li>Client验证<strong>公钥证书</strong>：比如是否在有效期内，证书的用途是不是匹配Client请求的站点，是不是在CRL吊销列表里面，它的上一级证书是否有效，这是一个递归的过程，直到验证到根证书（操作系统内置的Root证书或者Client内置的Root证书）。如果验证通过则继续，不通过则显示警告信息。</li>
<li>Client使用<strong>伪随机数生成器</strong>生成加密所使用的<strong>会话密钥</strong>，然后用证书的公钥加密这个<strong>会话密钥</strong>，发给Server。</li>
<li>Server使用自己的<strong>私钥</strong>（private key）解密这个消息，得到<strong>会话密钥</strong>。至此，Client和Server双方都持有了相同的<strong>会话密钥</strong>。</li>
<li>Server使用<strong>会话密钥</strong>加密“<strong>明文内容A</strong>”，发送给Client。</li>
<li>Client使用<strong>会话密钥</strong>解密响应的密文，得到“<strong>明文内容A</strong>”。</li>
<li>Client再次发起HTTPS的请求，使用会话密钥加密请求的“<strong>明文内容B</strong>”，然后Server使用<strong>会话密钥</strong>解密密文，得到“<strong>明文内容B</strong>”。</li>
</ol>
<h1 id="搭建https服务">搭建https服务</h1>
<h2 id="首先确认安装openssl">首先确认安装OpenSSL</h2>
<p>确定OpenSSL版本：</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#033">$openssl</span> version
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果版本低于1.0.1f，建议升级，因为1.0.1f版本之下的OpenSSL有一个Heartbleed漏洞。
安装OpenSSL：</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#033">$sudo</span> apt-get install openssl
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="自建ca">自建CA</h2>
<p>因为向CA申请签名是需要收费的，所以我们选择自己搭建一个CA来完成这个实验过程。
首先建立myCA目录用于存放CA相关信息</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#366">cd</span> <span style="color:#555">&amp;&amp;</span> mkdir -p myCA/signedcerts <span style="color:#555">&amp;&amp;</span> mkdir myCA/private <span style="color:#555">&amp;&amp;</span> <span style="color:#366">cd</span> myCA
</span></span></code></pre></td></tr></table>
</div>
</div><p>myCA 用于存放 CA 根证书，证书数据库，以及后续服务器生成的证书，密钥以及请求
signedcerts:保存签名证书的 copy
private: 包含私钥</p>
<p>之后配置myCA相关参数，在myCA目录下进行</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#366">echo</span> <span style="color:#c30">&#39;01&#39;</span>&gt;serial <span style="color:#555">&amp;&amp;</span> touch index.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后创建 caconfig.cnf 文件</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim ~/myCA/caconfig.cnf
</span></span></code></pre></td></tr></table>
</div>
</div><p>caconfig.cnf文件内容如下</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-1"> 1</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-2"> 2</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-3"> 3</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-4"> 4</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-5"> 5</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-6"> 6</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-7"> 7</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-8"> 8</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-9"> 9</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-10">10</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-11">11</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-12">12</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-13">13</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-14">14</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-15">15</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-16">16</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-17">17</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-18">18</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-19">19</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-20">20</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-21">21</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-22">22</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-23">23</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-24">24</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-25">25</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-26">26</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-27">27</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-28">28</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-29">29</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-30">30</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-31">31</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-32">32</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-33">33</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-34">34</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-35">35</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-36">36</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-37">37</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-38">38</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-39">39</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-40">40</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-41">41</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-42">42</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-43">43</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-44"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-44">44</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-45"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-45">45</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-46"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-46">46</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-47"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-47">47</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-48"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-48">48</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-49"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-49">49</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-50"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-50">50</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-51"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-51">51</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-52"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-52">52</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-53"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-53">53</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-54"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-54">54</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-55"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-55">55</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-56"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-56">56</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-57"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-57">57</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-58"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-58">58</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-59"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-59">59</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-60"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-60">60</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-61"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-61">61</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-62"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-62">62</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-63"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-63">63</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-64"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-64">64</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-65"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-65">65</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-66"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-66">66</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-67"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-67">67</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-68"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-68">68</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-69"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-69">69</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-70"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-70">70</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-71"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-71">71</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-72"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-72">72</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-73"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-73">73</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-74"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-74">74</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># My sample caconfig.cnf file.</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># Default configuration to use when one is not provided on the command line.</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#555">[</span> ca <span style="color:#555">]</span>
</span></span><span style="display:flex;"><span><span style="color:#033">default_ca</span>      <span style="color:#555">=</span> local_ca
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># Default location of directories and files needed to generate certificates.</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#555">[</span> local_ca <span style="color:#555">]</span>
</span></span><span style="display:flex;"><span><span style="color:#033">dir</span>             <span style="color:#555">=</span> /home/didi/myCA                    <span style="color:#09f;font-style:italic"># 这里要将username替换为你的用户名</span>
</span></span><span style="display:flex;"><span><span style="color:#033">certificate</span>     <span style="color:#555">=</span> <span style="color:#033">$dir</span>/cacert.pem
</span></span><span style="display:flex;"><span><span style="color:#033">database</span>        <span style="color:#555">=</span> <span style="color:#033">$dir</span>/index.txt
</span></span><span style="display:flex;"><span><span style="color:#033">new_certs_dir</span>   <span style="color:#555">=</span> <span style="color:#033">$dir</span>/signedcerts
</span></span><span style="display:flex;"><span><span style="color:#033">private_key</span>     <span style="color:#555">=</span> <span style="color:#033">$dir</span>/private/cakey.pem
</span></span><span style="display:flex;"><span><span style="color:#033">serial</span>          <span style="color:#555">=</span> <span style="color:#033">$dir</span>/serial
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#       </span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># Default expiration and encryption policies for certificates.</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#033">default_crl_days</span>        <span style="color:#555">=</span> <span style="color:#f60">365</span>
</span></span><span style="display:flex;"><span><span style="color:#033">default_days</span>            <span style="color:#555">=</span> <span style="color:#f60">1825</span>
</span></span><span style="display:flex;"><span><span style="color:#033">default_md</span>              <span style="color:#555">=</span> SHA256
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#       </span>
</span></span><span style="display:flex;"><span><span style="color:#033">policy</span>          <span style="color:#555">=</span> local_ca_policy
</span></span><span style="display:flex;"><span><span style="color:#033">x509_extensions</span> <span style="color:#555">=</span> local_ca_extensions
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#       </span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># Default policy to use when generating server certificates.  The following</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># fields must be defined in the server certificate.</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#555">[</span> local_ca_policy <span style="color:#555">]</span>
</span></span><span style="display:flex;"><span><span style="color:#033">commonName</span>              <span style="color:#555">=</span> supplied
</span></span><span style="display:flex;"><span><span style="color:#033">stateOrProvinceName</span>     <span style="color:#555">=</span> supplied
</span></span><span style="display:flex;"><span><span style="color:#033">countryName</span>             <span style="color:#555">=</span> supplied
</span></span><span style="display:flex;"><span><span style="color:#033">emailAddress</span>            <span style="color:#555">=</span> supplied
</span></span><span style="display:flex;"><span><span style="color:#033">organizationName</span>        <span style="color:#555">=</span> supplied
</span></span><span style="display:flex;"><span><span style="color:#033">organizationalUnitName</span>  <span style="color:#555">=</span> supplied
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#       </span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># x509 extensions to use when generating server certificates.</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#555">[</span> local_ca_extensions <span style="color:#555">]</span>
</span></span><span style="display:flex;"><span><span style="color:#033">subjectAltName</span>          <span style="color:#555">=</span> DNS:localhost
</span></span><span style="display:flex;"><span><span style="color:#033">basicConstraints</span>        <span style="color:#555">=</span> CA:false
</span></span><span style="display:flex;"><span><span style="color:#033">nsCertType</span>              <span style="color:#555">=</span> server
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#       </span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># The default root certificate generation policy.</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#555">[</span> req <span style="color:#555">]</span>
</span></span><span style="display:flex;"><span><span style="color:#033">default_bits</span>    <span style="color:#555">=</span> <span style="color:#f60">2048</span>
</span></span><span style="display:flex;"><span><span style="color:#033">default_keyfile</span> <span style="color:#555">=</span> /home/didi/myCA/private/cakey.pem  <span style="color:#09f;font-style:italic"># 这里要将username替换为你的用户名</span>
</span></span><span style="display:flex;"><span><span style="color:#033">default_md</span>      <span style="color:#555">=</span> SHA256
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#       </span>
</span></span><span style="display:flex;"><span><span style="color:#033">prompt</span>                  <span style="color:#555">=</span> no
</span></span><span style="display:flex;"><span><span style="color:#033">distinguished_name</span>      <span style="color:#555">=</span> root_ca_distinguished_name
</span></span><span style="display:flex;"><span><span style="color:#033">x509_extensions</span>         <span style="color:#555">=</span> root_ca_extensions
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># Root Certificate Authority distinguished name.  Change these fields to match</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># your local environment!</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#555">[</span> root_ca_distinguished_name <span style="color:#555">]</span>
</span></span><span style="display:flex;"><span><span style="color:#033">commonName</span>              <span style="color:#555">=</span> MyOwn Root Certificate Authority <span style="color:#09f;font-style:italic"># CA机构名</span>
</span></span><span style="display:flex;"><span><span style="color:#033">stateOrProvinceName</span>     <span style="color:#555">=</span> BJ                               <span style="color:#09f;font-style:italic"># CA所在省份</span>
</span></span><span style="display:flex;"><span><span style="color:#033">countryName</span>             <span style="color:#555">=</span> CN                               <span style="color:#09f;font-style:italic"># CA所在国家（仅限2个字符）</span>
</span></span><span style="display:flex;"><span><span style="color:#033">emailAddress</span>            <span style="color:#555">=</span> XXXX@XXX.com                     <span style="color:#09f;font-style:italic"># 邮箱</span>
</span></span><span style="display:flex;"><span><span style="color:#033">organizationName</span>        <span style="color:#555">=</span> XXX                              <span style="color:#09f;font-style:italic"># </span>
</span></span><span style="display:flex;"><span><span style="color:#033">organizationalUnitName</span>  <span style="color:#555">=</span> XXX                              <span style="color:#09f;font-style:italic"># </span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#       </span>
</span></span><span style="display:flex;"><span><span style="color:#555">[</span> root_ca_extensions <span style="color:#555">]</span>
</span></span><span style="display:flex;"><span><span style="color:#033">basicConstraints</span>        <span style="color:#555">=</span> CA:true
</span></span></code></pre></td></tr></table>
</div>
</div><p>生成 CA 根证书和密钥</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-1">1</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-2">2</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#366">export</span> <span style="color:#033">OPENSSL_CONF</span><span style="color:#555">=</span>~/myCA/caconfig.cnf       <span style="color:#09f;font-style:italic">#该命令用于给环境变量 OPENSSL_CONF 赋值为caconfig.cnf。</span>
</span></span><span style="display:flex;"><span>openssl req -x509 -newkey rsa:2048 -out cacert.pem -outform PEM -days <span style="color:#f60">1825</span>             <span style="color:#09f;font-style:italic"># 生成 CA 根证书和密钥</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>该命令需要用户设置密码。不要忘记。
以上步骤生成了 CA 自签名根证书，和 RSA 公/私密钥对。证书的格式是 PEM，有效期是1825天。</p>
<ul>
<li>/myCA/cacert.pem: CA 根证书</li>
<li>/myCA/private/cakey.pem： CA 私钥</li>
</ul>
<h2 id="创建服务器公私钥">创建服务器公私钥</h2>
<p>生成服务器配置文件exampleserver.cnf</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim ~/myCA/exampleserver.cnf
</span></span></code></pre></td></tr></table>
</div>
</div><p>exampleserver.cnf文件内容如下</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-1"> 1</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-2"> 2</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-3"> 3</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-4"> 4</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-5"> 5</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-6"> 6</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-7"> 7</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-8"> 8</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-9"> 9</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-10">10</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-11">11</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-12">12</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-13">13</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-14">14</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-15">15</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># exampleserver.cnf</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#555">[</span> req <span style="color:#555">]</span>
</span></span><span style="display:flex;"><span><span style="color:#033">prompt</span>             <span style="color:#555">=</span> no
</span></span><span style="display:flex;"><span><span style="color:#033">distinguished_name</span> <span style="color:#555">=</span> server_distinguished_name
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#555">[</span> server_distinguished_name <span style="color:#555">]</span>
</span></span><span style="display:flex;"><span><span style="color:#033">commonName</span>              <span style="color:#555">=</span> localhost          <span style="color:#09f;font-style:italic"># 服务器域名</span>
</span></span><span style="display:flex;"><span><span style="color:#033">stateOrProvinceName</span>     <span style="color:#555">=</span> BJ                 <span style="color:#09f;font-style:italic"># 服务器所在省份</span>
</span></span><span style="display:flex;"><span><span style="color:#033">countryName</span>             <span style="color:#555">=</span> CN                 <span style="color:#09f;font-style:italic"># 服务器所在国家（仅限2个字符）</span>
</span></span><span style="display:flex;"><span><span style="color:#033">emailAddress</span>            <span style="color:#555">=</span> XXXX@XXX.com       <span style="color:#09f;font-style:italic"># 邮箱</span>
</span></span><span style="display:flex;"><span><span style="color:#033">organizationName</span>        <span style="color:#555">=</span> XXX                <span style="color:#09f;font-style:italic"># </span>
</span></span><span style="display:flex;"><span><span style="color:#033">organizationalUnitName</span>  <span style="color:#555">=</span> XXX                <span style="color:#09f;font-style:italic"># </span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>生成服务器证书和密钥</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-1">1</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-2">2</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#366">export</span> <span style="color:#033">OPENSSL_CONF</span><span style="color:#555">=</span>~/myCA/exampleserver.cnf   <span style="color:#09f;font-style:italic"># 该命令设置环境变量 OPENSSL_CONF，使得 openssl 更换配置文件。</span>
</span></span><span style="display:flex;"><span>openssl req -newkey rsa:1024 -keyout tempkey.pem -keyform PEM -out tempreq.pem -outform PEM
</span></span></code></pre></td></tr></table>
</div>
</div><p>同样的，需要输入密码短语。
之后，有2种对临时秘钥的操作，选择其一即可
1.将临时私钥转换为 unencrypted key，即秘钥不加密状态。</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>openssl rsa -in tempkey.pem -out server_key.pem
</span></span></code></pre></td></tr></table>
</div>
</div><p>需要输入密码短语。</p>
<p>2.如果希望将 key 保持为加密状态，直接改名</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mv tempkey.pem server_key.pem
</span></span></code></pre></td></tr></table>
</div>
</div><p>两者的区别是，第二种需要在服务器启动时输入私钥的密码短语，否则会导致服务器启动失败，但第二种安全性高于第一种，可以更好的保护秘钥。</p>
<h2 id="使用-ca-key-对服务器证书签名">使用 CA key 对服务器证书签名</h2>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-1">1</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-2">2</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#366">export</span> <span style="color:#033">OPENSSL_CONF</span><span style="color:#555">=</span>~/myCA/caconfig.cnf
</span></span><span style="display:flex;"><span>openssl ca -in tempkey.pem -out server_crt.pem
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里提示：</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-1">1</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-2">2</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-3">3</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Can<span style="color:#c30">&#39;t open /home/shawn/myCA/index.txt.attr for reading, No such file or directory
</span></span></span><span style="display:flex;"><span><span style="color:#c30">140344032040704:error:02001002:system library:fopen:No such file or directory:crypto/bio/bss_file.c:74:fopen(&#39;</span>/home/shawn/myCA/index.txt.attr<span style="color:#c30">&#39;,&#39;</span>r<span style="color:#a00;background-color:#faa">&#39;</span><span style="color:#555">)</span>
</span></span><span style="display:flex;"><span>140344032040704:error:2006D080:BIO routines:BIO_new_file:no such file:crypto/bio/bss_file.c:81:
</span></span></code></pre></td></tr></table>
</div>
</div><p>是Openssl的bug，在myCA目录下再touch一个index.txt.attr即可</p>
<p>删除临时证书和密码文件</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rm -f tempkey.pem <span style="color:#555">&amp;&amp;</span> rm -f tempreq.pem
</span></span></code></pre></td></tr></table>
</div>
</div><p>现在，自签名的服务器证书和密钥对便产生了：</p>
<ul>
<li>server_crt.pem : 服务器证书文件</li>
<li>server_key.pem : 服务器密钥文件</li>
</ul>
<h2 id="搭建https工程">搭建https工程</h2>
<p>基于 <a href="https://github.com/yhirose/cpp-httplib" target="_blank" rel="noopener noreffer ">cpp-httplib</a>搭建工程 ， 工程地址 ：<a href="https://gitee.com/fromyuhu/http-https" target="_blank" rel="noopener noreffer ">http-https</a></p>
<ol>
<li>server 端代码</li>
</ol>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-1"> 1</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-2"> 2</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-3"> 3</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-4"> 4</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-5"> 5</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-6"> 6</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-7"> 7</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-8"> 8</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-9"> 9</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-10">10</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-11">11</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-12">12</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-13">13</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-14">14</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-15">15</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-16">16</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-17">17</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-18">18</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-19">19</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-20">20</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-21">21</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-22">22</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-23">23</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-24">24</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-25">25</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-26">26</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-27">27</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-28">28</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-29">29</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-30">30</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-31">31</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-32">32</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-33">33</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-34">34</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-35">35</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-36">36</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-37">37</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-38">38</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-39">39</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-40">40</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-41">41</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-42">42</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-43">43</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-44"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-44">44</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-45"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-45">45</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-46"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-46">46</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-47"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-47">47</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-48"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-48">48</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-49"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-49">49</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-50"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-50">50</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-51"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-51">51</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-52"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-52">52</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-53"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-53">53</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-54"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-54">54</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-55"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-55">55</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-56"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-56">56</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-57"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-57">57</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-58"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-58">58</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-59"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-59">59</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-60"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-60">60</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-61"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-61">61</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-62"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-62">62</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-63"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-63">63</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-64"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-64">64</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-65"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-65">65</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-66"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-66">66</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-67"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-67">67</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-68"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-68">68</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-69"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-69">69</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-70"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-70">70</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-71"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-71">71</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-72"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-72">72</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-73"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-73">73</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-74"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-74">74</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-75"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-75">75</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-76"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-76">76</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-77"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-77">77</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-78"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-78">78</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-79"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-79">79</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-80"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-80">80</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-81"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-81">81</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-82"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-82">82</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-83"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-83">83</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-84"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-84">84</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-85"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-85">85</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-86"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-86">86</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-87"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-87">87</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-88"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-88">88</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-89"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-89">89</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#099">#include</span> <span style="color:#099">&lt;httplib.h&gt;</span><span style="color:#099">
</span></span></span><span style="display:flex;"><span><span style="color:#099">#include</span> <span style="color:#099">&lt;fstream&gt;</span><span style="color:#099">
</span></span></span><span style="display:flex;"><span><span style="color:#099">#include</span> <span style="color:#099">&lt;iostream&gt;</span><span style="color:#099">
</span></span></span><span style="display:flex;"><span><span style="color:#099">#include</span> <span style="color:#099">&lt;string&gt;</span><span style="color:#099">
</span></span></span><span style="display:flex;"><span><span style="color:#099"></span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">using</span> <span style="color:#069;font-weight:bold">namespace</span> std<span style="color:#555">::</span>placeholders;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">TEST</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">private</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>    httplib<span style="color:#555">::</span>Server <span style="color:#555">*</span>m_svr;
</span></span><span style="display:flex;"><span>    <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">recvGetHelloHandle</span>(<span style="color:#069;font-weight:bold">const</span> httplib<span style="color:#555">::</span>Request <span style="color:#555">&amp;</span>req, httplib<span style="color:#555">::</span>Response <span style="color:#555">&amp;</span>res);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">public</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>    TEST();
</span></span><span style="display:flex;"><span>    <span style="color:#555">~</span>TEST()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">delete</span> m_svr;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">start</span>(<span style="color:#078;font-weight:bold">int</span> port)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        m_svr<span style="color:#555">-&gt;</span>listen(<span style="color:#c30">&#34;0.0.0.0&#34;</span>, port);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TEST<span style="color:#555">::</span>TEST()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    m_svr <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> httplib<span style="color:#555">::</span>Server;
</span></span><span style="display:flex;"><span>    httplib<span style="color:#555">::</span>Server<span style="color:#555">::</span>Handler getHello_cb <span style="color:#555">=</span> std<span style="color:#555">::</span>bind(<span style="color:#555">&amp;</span>TEST<span style="color:#555">::</span>recvGetHelloHandle, <span style="color:#069;font-weight:bold">this</span>, _1, _2);
</span></span><span style="display:flex;"><span>    m_svr<span style="color:#555">-&gt;</span>Get(<span style="color:#c30">&#34;/hello&#34;</span>, getHello_cb);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> TEST<span style="color:#555">::</span>recvGetHelloHandle(<span style="color:#069;font-weight:bold">const</span> httplib<span style="color:#555">::</span>Request <span style="color:#555">&amp;</span>req, httplib<span style="color:#555">::</span>Response <span style="color:#555">&amp;</span>res)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> (<span style="color:#555">!</span>req.has_header(<span style="color:#c30">&#34;token&#34;</span>))
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        res.set_content(<span style="color:#c30">&#34;fail&#34;</span>, <span style="color:#c30">&#34;text/plain&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    std<span style="color:#555">::</span>string token <span style="color:#555">=</span> req.get_header_value(<span style="color:#c30">&#34;token&#34;</span>);
</span></span><span style="display:flex;"><span>    std<span style="color:#555">::</span>cout <span style="color:#555">&lt;&lt;</span> <span style="color:#c30">&#34;token : &#34;</span> <span style="color:#555">&lt;&lt;</span> token <span style="color:#555">&lt;&lt;</span> std<span style="color:#555">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">TESTHTTPS</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">private</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>    httplib<span style="color:#555">::</span>SSLServer <span style="color:#555">*</span>m_svr;
</span></span><span style="display:flex;"><span>    <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">recvGetHelloHandle</span>(<span style="color:#069;font-weight:bold">const</span> httplib<span style="color:#555">::</span>Request <span style="color:#555">&amp;</span>req, httplib<span style="color:#555">::</span>Response <span style="color:#555">&amp;</span>res);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">public</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>    TESTHTTPS();
</span></span><span style="display:flex;"><span>    <span style="color:#555">~</span>TESTHTTPS()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">delete</span> m_svr;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">start</span>(<span style="color:#078;font-weight:bold">int</span> port)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        m_svr<span style="color:#555">-&gt;</span>listen(<span style="color:#c30">&#34;localhost&#34;</span>, port);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TESTHTTPS<span style="color:#555">::</span>TESTHTTPS()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    m_svr <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> httplib<span style="color:#555">::</span>SSLServer(<span style="color:#c30">&#34;./data/server_crt.pem&#34;</span>, <span style="color:#c30">&#34;./data/server_key.pem&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    httplib<span style="color:#555">::</span>SSLServer<span style="color:#555">::</span>Handler getHello_cb <span style="color:#555">=</span> std<span style="color:#555">::</span>bind(<span style="color:#555">&amp;</span>TESTHTTPS<span style="color:#555">::</span>recvGetHelloHandle, <span style="color:#069;font-weight:bold">this</span>, _1, _2);
</span></span><span style="display:flex;"><span>    m_svr<span style="color:#555">-&gt;</span>Get(<span style="color:#c30">&#34;/dd/hello&#34;</span>, getHello_cb);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> TESTHTTPS<span style="color:#555">::</span>recvGetHelloHandle(<span style="color:#069;font-weight:bold">const</span> httplib<span style="color:#555">::</span>Request <span style="color:#555">&amp;</span>req, httplib<span style="color:#555">::</span>Response <span style="color:#555">&amp;</span>res)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> (<span style="color:#555">!</span>req.has_header(<span style="color:#c30">&#34;token&#34;</span>))
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        res.set_content(<span style="color:#c30">&#34;fail&#34;</span>, <span style="color:#c30">&#34;text/plain&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    std<span style="color:#555">::</span>string token <span style="color:#555">=</span> req.get_header_value(<span style="color:#c30">&#34;token&#34;</span>);
</span></span><span style="display:flex;"><span>    std<span style="color:#555">::</span>cout <span style="color:#555">&lt;&lt;</span> <span style="color:#c30">&#34;token : &#34;</span> <span style="color:#555">&lt;&lt;</span> token <span style="color:#555">&lt;&lt;</span> std<span style="color:#555">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#078;font-weight:bold">int</span> <span style="color:#c0f">main</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    TESTHTTPS test;
</span></span><span style="display:flex;"><span>    test.start(<span style="color:#f60">8887</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>client 端代码</li>
</ol>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-1"> 1</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-2"> 2</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-3"> 3</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-4"> 4</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-5"> 5</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-6"> 6</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-7"> 7</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-8"> 8</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-9"> 9</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-10">10</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-11">11</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-12">12</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-13">13</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-14">14</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-15">15</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-16">16</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-17">17</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-18">18</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-19">19</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-20">20</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-21">21</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-22">22</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-23">23</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-24">24</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-25">25</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-26">26</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-27">27</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-28">28</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-29">29</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-30">30</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-31">31</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-32">32</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-33">33</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-34">34</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-35">35</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-36">36</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-37">37</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-38">38</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-39">39</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-40">40</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-41">41</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-42">42</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-43">43</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-44"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-44">44</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-45"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-45">45</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-46"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-46">46</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-47"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-47">47</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-48"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-48">48</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-49"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-49">49</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-50"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-50">50</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-51"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-51">51</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-52"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-52">52</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-53"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-53">53</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-54"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-54">54</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-55"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-55">55</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-56"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-56">56</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-57"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-57">57</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-58"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-58">58</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-59"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-59">59</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-60"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-60">60</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-61"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-61">61</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-62"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-62">62</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-63"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-63">63</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-64"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-64">64</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-65"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-65">65</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-66"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-66">66</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-67"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-67">67</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-68"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-68">68</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-69"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-69">69</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-70"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-70">70</a>
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-71"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-71">71</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#099">#include</span> <span style="color:#099">&lt;httplib.h&gt;</span><span style="color:#099">
</span></span></span><span style="display:flex;"><span><span style="color:#099">#include</span> <span style="color:#099">&lt;fstream&gt;</span><span style="color:#099">
</span></span></span><span style="display:flex;"><span><span style="color:#099">#include</span> <span style="color:#099">&lt;iostream&gt;</span><span style="color:#099">
</span></span></span><span style="display:flex;"><span><span style="color:#099">#include</span> <span style="color:#099">&lt;string&gt;</span><span style="color:#099">
</span></span></span><span style="display:flex;"><span><span style="color:#099"></span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">TESTHTTP</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">private</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>    httplib<span style="color:#555">::</span>Client <span style="color:#555">*</span>m_cli;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">public</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>    TESTHTTP()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        m_cli <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> httplib<span style="color:#555">::</span>Client(<span style="color:#c30">&#34;https://localhost:8887&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#555">~</span>TESTHTTP()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">delete</span> m_cli;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>c<span style="color:#555">++</span>
</span></span><span style="display:flex;"><span>    <span style="color:#078;font-weight:bold">void</span> testGetHello();
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> TESTHTTP<span style="color:#555">::</span>testGetHello()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    httplib<span style="color:#555">::</span>Params params <span style="color:#555">=</span> {{<span style="color:#c30">&#34;params&#34;</span>, <span style="color:#c30">&#34;test&#34;</span>}};
</span></span><span style="display:flex;"><span>    httplib<span style="color:#555">::</span>Headers headers <span style="color:#555">=</span> {{<span style="color:#c30">&#34;version&#34;</span>, <span style="color:#c30">&#34;0.0.0.1&#34;</span>},
</span></span><span style="display:flex;"><span>                                {<span style="color:#c30">&#34;token&#34;</span>, <span style="color:#c30">&#34;V66n56XJBD/4LTMsGDqE0dlRPtkVmQ0hlIQNwcBMZkU4bQeDTBlMEUluqnha1g/ZsEMK/0JHKtEBwHH2Ko9iEA==&#34;</span>}};
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">auto</span> res <span style="color:#555">=</span> m_cli<span style="color:#555">-&gt;</span>Get(<span style="color:#c30">&#34;/dd/hello&#34;</span>, params, headers);
</span></span><span style="display:flex;"><span>    std<span style="color:#555">::</span>cout <span style="color:#555">&lt;&lt;</span> httplib<span style="color:#555">::</span>to_string(res.error()) <span style="color:#555">&lt;&lt;</span> std<span style="color:#555">::</span>endl;
</span></span><span style="display:flex;"><span>    std<span style="color:#555">::</span>cout <span style="color:#555">&lt;&lt;</span> res<span style="color:#555">-&gt;</span>body <span style="color:#555">&lt;&lt;</span> std<span style="color:#555">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">TESTHTTPS</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">private</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>    httplib<span style="color:#555">::</span>Client <span style="color:#555">*</span>m_cli;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">public</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>    TESTHTTPS()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        m_cli <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> httplib<span style="color:#555">::</span>Client(<span style="color:#c30">&#34;https://localhost:8887&#34;</span>);
</span></span><span style="display:flex;"><span>        m_cli<span style="color:#555">-&gt;</span>set_ca_cert_path(<span style="color:#c30">&#34;./data/cacert.pem&#34;</span>);
</span></span><span style="display:flex;"><span>        m_cli<span style="color:#555">-&gt;</span>enable_server_certificate_verification(<span style="color:#366">true</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#555">~</span>TESTHTTPS()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">delete</span> m_cli;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">testGetHello</span>();
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> TESTHTTPS<span style="color:#555">::</span>testGetHello()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    httplib<span style="color:#555">::</span>Params params <span style="color:#555">=</span> {{<span style="color:#c30">&#34;params&#34;</span>, <span style="color:#c30">&#34;test&#34;</span>}};
</span></span><span style="display:flex;"><span>    httplib<span style="color:#555">::</span>Headers headers <span style="color:#555">=</span> {{<span style="color:#c30">&#34;version&#34;</span>, <span style="color:#c30">&#34;0.0.0.1&#34;</span>},
</span></span><span style="display:flex;"><span>                                {<span style="color:#c30">&#34;token&#34;</span>, <span style="color:#c30">&#34;V66n56XJBD/4LTMsGDqE0dlRPtkVmQ0hlIQNwcBMZkU4bQeDTBlMEUluqnha1g/ZsEMK/0JHKtEBwHH2Ko9iEA==&#34;</span>}};
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">auto</span> res <span style="color:#555">=</span> m_cli<span style="color:#555">-&gt;</span>Get(<span style="color:#c30">&#34;/dd/hello&#34;</span>, params, headers);
</span></span><span style="display:flex;"><span>    std<span style="color:#555">::</span>cout <span style="color:#555">&lt;&lt;</span> httplib<span style="color:#555">::</span>to_string(res.error()) <span style="color:#555">&lt;&lt;</span> std<span style="color:#555">::</span>endl;
</span></span><span style="display:flex;"><span>    std<span style="color:#555">::</span>cout <span style="color:#555">&lt;&lt;</span> res<span style="color:#555">-&gt;</span>body <span style="color:#555">&lt;&lt;</span> std<span style="color:#555">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#078;font-weight:bold">int</span> <span style="color:#c0f">main</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#09f;font-style:italic">// TESTHTTP T;
</span></span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"></span>    <span style="color:#09f;font-style:italic">// T.testPostPush();
</span></span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    TESTHTTPS T;
</span></span><span style="display:flex;"><span>    T.testGetHello();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="参考">参考</h1>
<p><a href="https://www.cnblogs.com/libaoquan/p/7965873.html" target="_blank" rel="noopener noreffer ">信安实践——自建CA证书搭建https服务器 </a>
<a href="https://www.cnblogs.com/linianhui/p/security-https-workflow.html" target="_blank" rel="noopener noreffer ">HTTPS工作流程</a></p>
<h1 id="测试工程">测试工程</h1>
<p><a href="https://gitee.com/fromyuhu/http-https" target="_blank" rel="noopener noreffer ">http-https</a></p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-02-09</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://zhangyuhu.github.io/posts/basic_knowledge/network/http/https%E5%AE%9E%E7%8E%B0/" data-title="HTTP:HTTPS实现" data-hashtags="network,HTTP"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://zhangyuhu.github.io/posts/basic_knowledge/network/http/https%E5%AE%9E%E7%8E%B0/" data-hashtag="network"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://zhangyuhu.github.io/posts/basic_knowledge/network/http/https%E5%AE%9E%E7%8E%B0/" data-title="HTTP:HTTPS实现"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://zhangyuhu.github.io/posts/basic_knowledge/network/http/https%E5%AE%9E%E7%8E%B0/" data-title="HTTP:HTTPS实现"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://zhangyuhu.github.io/posts/basic_knowledge/network/http/https%E5%AE%9E%E7%8E%B0/" data-title="HTTP:HTTPS实现" data-ralateuid="ji"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/network/">network</a>,&nbsp;<a href="/tags/http/">HTTP</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/basic_knowledge/network/http/http/" class="prev" rel="prev" title="HTTP:HTTP介绍"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>HTTP:HTTP介绍</a>
            <a href="/posts/embedded/developmentboard/%E5%9C%B0%E5%B9%B3%E7%BA%BF%E6%97%AD%E6%97%A5x3/%E5%9C%B0%E5%B9%B3%E7%BA%BF%E6%97%AD%E6%97%A5x3/" class="next" rel="next" title="Embedded:地平线旭日X3">Embedded:地平线旭日X3<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="giscus" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://giscus.app">Giscus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">为天地立心,为生民立命,为往圣继绝学,为万世开太平</div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://zhangyuhu.github.io/" target="_blank">zhangyuhu</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="http://creativecommons.org/licenses/by/4.0/" target="_blank">知识共享署名 4.0 国际许可协议</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":100},"comment":{"giscus":{"category":"Comments","categoryId":"DIC_kwDOIx2Cjs4CTnUX","darkTheme":"dark","emitMetadata":"0","inputPosition":"bottom","lang":"en","lazyLoading":false,"lightTheme":"light","mapping":"pathname","reactionsEnabled":"1","repo":"zhangyuhu/zhangyuhu.github.io","repoId":"R_kgDOIx2Cjg"}},"data":{"id-1":"HOME","id-2":"HOME"},"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":50,"type":"lunr"},"twemoji":true,"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.2970a33d719df7cd89cebf586152b32a8ed30012227fa81b44282950146e0f595d1c733779e4d423dda1004bdcf707ee64d0fadc3d21229cd66b960788f84bdb.js" integrity="sha512-KXCjPXGd982Jzr9YYVKzKo7TABIif6gbRCgpUBRuD1ldHHM3eeTUI92hAEvc9wfuZND63D0hIpzWa5YHiPhL2w=="></script></body>
</html>
